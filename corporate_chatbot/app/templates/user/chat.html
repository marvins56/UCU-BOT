{% extends "base.html" %}
{% block content %}
<div class="min-h-screen bg-gray-50 dark:bg-gray-900 transition-colors duration-200">
    <!-- Header -->
    <nav class="fixed top-0 w-full bg-white dark:bg-gray-800 shadow-sm z-10">
        <div class="max-w-7xl mx-auto px-4 py-3">
            <div class="flex items-center justify-between">
                <div class="flex items-center space-x-3">
                    <div class="h-10 w-10 rounded-full bg-blue-100 dark:bg-blue-900 flex items-center justify-center">
                        <svg class="h-6 w-6 text-blue-600 dark:text-blue-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 10h.01M12 10h.01M16 10h.01M9 16H5a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v8a2 2 0 01-2 2h-4l-4 4z"/>
                        </svg>
                    </div>
                    <div>
                        <h1 class="text-xl font-semibold text-gray-800 dark:text-white">AI Assistant</h1>
                        <p class="text-sm text-gray-500 dark:text-gray-400">Online</p>
                    </div>
                </div>
                <button id="theme-toggle" class="p-2 rounded-lg bg-gray-100 dark:bg-gray-700 hover:bg-gray-200 dark:hover:bg-gray-600">
                    <svg class="w-5 h-5 text-gray-800 dark:text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z"/>
                    </svg>
                </button>
            </div>
        </div>
    </nav>

    <!-- Chat Container -->
    <div class="pt-20 pb-24 px-4 max-w-4xl mx-auto">
        <div class="h-[calc(100vh-180px)] overflow-y-auto px-2 space-y-6" id="chat-messages">
            <!-- Bot Message -->
            <div class="flex items-start space-x-3 animate-fade-in">
                <div class="flex-shrink-0">
                    <div class="h-8 w-8 rounded-full bg-blue-100 dark:bg-blue-900 flex items-center justify-center">
                        <svg class="h-5 w-5 text-blue-600 dark:text-blue-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 10h.01M12 10h.01M16 10h.01M9 16H5a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v8a2 2 0 01-2 2h-4l-4 4z"/>
                        </svg>
                    </div>
                </div>
                <div class="flex flex-col space-y-2 max-w-[80%]">
                    <div class="bg-white dark:bg-gray-800 rounded-2xl rounded-tl-none px-4 py-2 shadow-sm">
                        <p class="text-gray-800 dark:text-gray-200">Hello! How can I assist you today?</p>
                    </div>
                    <span class="text-xs text-gray-500 dark:text-gray-400 ml-2">11:30 AM</span>
                </div>
            </div>
        </div>

       <!-- Floating Input Area -->
<div class="fixed bottom-0 left-0 right-0 bg-gradient-to-t from-gray-50 dark:from-gray-900 to-transparent pt-10">
    <div class="max-w-4xl mx-auto px-4 pb-6">
        <form id="chat-form" class="relative">
            <div class="bg-white dark:bg-gray-800 rounded-2xl shadow-lg p-2">
                <div class="flex items-center space-x-2"> <!-- Changed to items-center -->
                    <div class="flex-grow">
                        <textarea 
                            class="w-full bg-transparent border-0 focus:ring-0 focus:outline-none resize-none p-2 max-h-32 text-gray-800 dark:text-white placeholder-gray-400 dark:placeholder-gray-500"
                            placeholder="Type your message..."
                            rows="1"
                            style="min-height: 44px;"
                        ></textarea>
                    </div>
                    <div class="flex items-center space-x-2 flex-shrink-0"> <!-- Added flex-shrink-0 -->
                        <button type="button" class="p-2.5 rounded-full hover:bg-gray-100 dark:hover:bg-gray-700 text-gray-400 dark:text-gray-500 transition-colors">
                            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M14.828 14.828a4 4 0 01-5.656 0M9 10h.01M15 10h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"/>
                            </svg>
                        </button>
                        <button type="submit" class="p-2.5 rounded-full bg-blue-600 hover:bg-blue-700 text-white transition-colors">
                            <svg class="w-5 h-5 rotate-90" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 19l9 2-9-18-9 18 9-2zm0 0v-8"/>
                            </svg>
                        </button>
                    </div>
                </div>
            </div>
        </form>
    </div>
</div>
    </div>
</div>

<script>
// Dark mode toggle
document.getElementById('theme-toggle').addEventListener('click', function() {
    document.documentElement.classList.toggle('dark');
    localStorage.theme = document.documentElement.classList.contains('dark') ? 'dark' : 'light';
});

// Auto-expanding textarea
const textarea = document.querySelector('textarea');
textarea.addEventListener('input', function() {
    this.style.height = 'auto';
    this.style.height = (this.scrollHeight) + 'px';
});

// Handle form submission
document.getElementById('chat-form').addEventListener('submit', function(e) {
    e.preventDefault();
    const textarea = this.querySelector('textarea');
    const message = textarea.value.trim();
    
    if (message) {
        const chatMessages = document.getElementById('chat-messages');
        const timestamp = new Date().toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' });
        
        const messageHTML = `
            <div class="flex items-start justify-end space-x-3 animate-fade-in">
                <div class="flex flex-col items-end space-y-2 max-w-[80%]">
                    <div class="bg-blue-600 text-white rounded-2xl rounded-tr-none px-4 py-2 shadow-sm">
                        <p>${message}</p>
                    </div>
                    <span class="text-xs text-gray-500 dark:text-gray-400 mr-2">${timestamp}</span>
                </div>
                <div class="h-8 w-8 rounded-full bg-gray-200 dark:bg-gray-700 flex items-center justify-center">
                    <svg class="h-5 w-5 text-gray-500 dark:text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"/>
                    </svg>
                </div>
            </div>
        `;
        
        chatMessages.insertAdjacentHTML('beforeend', messageHTML);
        chatMessages.scrollTop = chatMessages.scrollHeight;
        textarea.value = '';
        textarea.style.height = 'auto';
    }
});

// Check for saved theme preference
if (localStorage.theme === 'dark' || (!('theme' in localStorage) && window.matchMedia('(prefers-color-scheme: dark)').matches)) {
    document.documentElement.classList.add('dark');
} else {
    document.documentElement.classList.remove('dark');
}
</script>
{% endblock %}